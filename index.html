<!DOCTYPE HTML>

<!--[if lt IE 7 ]> <html class="ie ie6 ie-lt10 ie-lt9 ie-lt8 ie-lt7 no-js" lang="en"> <![endif]-->
<!--[if IE 7 ]>    <html class="ie ie7 ie-lt10 ie-lt9 ie-lt8 no-js" lang="en"> <![endif]-->
<!--[if IE 8 ]>    <html class="ie ie8 ie-lt10 ie-lt9 no-js" lang="en"> <![endif]-->
<!--[if IE 9 ]>    <html class="ie ie9 ie-lt10 no-js" lang="en"> <![endif]-->
<!--[if gt IE 9]><!--><html class="no-js" lang="en"><!--<![endif]-->
<!-- the "no-js" class is for Modernizr. -->

    <head>
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, user-scalable=no">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="description" content="Check local weather listings and see if the conditions in your area are suitable for rowing.">
        <meta name="author" content="Evan Merkel">
        <meta name="copyright" content="Evan Merkel">
        <meta name="keywords" content="weather, rowing, conditions, location">
        <meta name="robots" content="index, follow">
        
        <link type="text/css" rel="stylesheet" href="css/reset.css">
        <link type="text/css" rel="stylesheet" href="css/styles.css">
        <link type="text/css" rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">
        <link rel="icon" type="image/png" href="images/favicon.png">
        
        <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.8.3/modernizr.js"></script>
        <script type="text/javascript" src="http://cdnjs.cloudflare.com/ajax/libs/jquery.simpleWeather/3.1.0/jquery.simpleWeather.min.js"></script>
        
        <title>Should I Row?</title>
    </head>
    
    <body>
        <div id="background"></div>
        <div id="content">
            <div class="container">
                <p id="current-zip">Current location: <input type="text" name="location" id="zip"><button id="update">Set Location</button></p>
                <p id="time"></p>
                
                <a id="show-menu"><i class="fa fa-fw fa-3x fa-bars"></i></a>
                
                <div class="menu">
                    <ul>
                        <li><a href="http://www.spc.noaa.gov/faq/tornado/beaufort.html">Beaufort Scale</a></li>
                        <li><a href="">link</a></li>
                        <li><a href="">link</a></li>
                        <li><a href="">link</a></li>
                        <li>
                            <p>This web app was developed in response to the confusion that prefaced practice some mornings. For Virginia Tech
                            Crew, our beloved Claytor lake is about a 30 minute drive from campus, making transit time each morning about an
                             hour long. Sometimes, everyone would show up at Claytor only to find that inclement weather had frozen the dock,
                            or that winds were too high to row, or that the temperature had fallen as much as 10 degrees. Then we would hae to
                            turn around and head back, wasting gas, time, and sleep. This app is intended to be used as a resource for coaches 
                            and crews who want to look up rowing conditions before practice. Simply enter your city or zip code and you can see 
                            what conditions are like! Go Hokies!</p>
                        </li>
                    </ul>
                </div>
                
                <div class="container">
                    <!-- fa-meh-o, fa-smile-o fa-frown-o -->
                    <p class="message">Row <i class="fa fa-smile-o"></i></p>
                    <div id="weather">Loading current dataâ€¦</div>
                    <img id="logo" src="images/vt-crew-logo-new-white.png">
                </div>
                
                <p class="author">Created by Evan Merkel // Copyright &copy; 2016</p>
            </div>
        </div>
        
        <script>
            var map;
            function initMap() {
                map = new google.maps.Map(document.getElementById('background'), {
                    center: {lat: 37.056, lng: -80.6133},
                    zoom: 15,
                    disableDefaultUI: true,
                    mapTypeId: google.maps.MapTypeId.HYBRID
                });
            }
        </script>
        
        <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCrop61uOpWr2HVsotLNfOQ5-lNBgIgKNs&callback=initMap"></script>
        
        <script>
            //timestamp
            stamp = new Date();
            year = 1900 + stamp.getYear();
            var hours, mins, time;
            hours = stamp.getHours();
            if (hours >= 12) time = " PM";
            else time = " AM";
            if (hours > 12) hours -= 12;
            if (hours == 0) hours = 12;
            mins = stamp.getMinutes();
            if (mins < 10) mins = "0" + mins;
            document.getElementById('time').innerHTML = '<span>Page loaded at: ' + hours + ':' + mins + time + ' on ' + (stamp.getMonth() + 1) + '/' + stamp.getDate()+ '/' + year + '</span>';
        </script>
        
        <script>
            //get weather data
            $(document).ready(function() {
                var tempTolerance = 20,
                    windToleranceMid = 10,
                    windToleranceHigh = 16,
                    newLocation = 'Pulaski, VA';
                $.simpleWeather({
                    location: newLocation,
                    woeid: '',
                    unit: 'f',
                    success: function(weather) {
                        html = '<ul class="conditions"><li class="temp"> '+weather.temp+'&deg;'+weather.units.temp+'<span class="wc"> (Wind chill '+weather.wind.chill+'&deg;)</span></li>';
                        html += '<li class="currently">'+weather.currently+'</li>';
                        html += '<li class="winds">Winds '+weather.wind.direction+' '+weather.wind.speed+' '+weather.units.speed+'<span class="wc"> ('+weather.wind.speed * 0.87+' knots)</span></li></ul>';
                        
                        html2 = weather.city+', '+weather.region;
                        
                        $('#weather').html(html);
                        
                        // message conditions
                        if (weather.wind.speed >= windToleranceMid && weather.wind.speed < windToleranceHigh || weather.temp <= tempTolerance) {
                            $('.message').html('Probably Don\'t Row <i class="fa fa-meh-o"></i>');
                        } else if (weather.wind.speed >= windToleranceHigh) {
                            $('.message').html('Don\'t Row <i class="fa fa-frown-o"></i>');
                        }
                        
                        $('#zip').val(html2);
                    },
                    error: function(error) {
                        $('#weather').html('<p>'+error+'</p>');
                    }
                });
                
                //end weather, begin other jQuery
                $('#show-menu').click(function() {
                    $('.menu').toggleClass('visible');
                    return false;
                });
                
                //set location to user input
                $('#update').click(function() {
                    newLocation = $('#zip').val();
                    console.log(newLocation);
                });
                
                //my attempt to make links generated by google maps inaccessible to users
                $('#background').find('a').attr('tabindex', '-1');
            });
        </script>
    </body>
</html>
